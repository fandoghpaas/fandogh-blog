##  دیپلوی کردن وردپرس با فندق
وردپرس یک سیستم مدیریت محتوای بسیار پرطرفدار است که می‌توانید به سادگی روی پلتفرم فندق دیپلوی و استفاده کنید. در این مطلب قصد داریم با هم مراحل دیپلوی کردن وردپرس روی فندق را مرور کنیم.

### خلاصه مراحل
1.  یک اکانت فندق می‌سازید و فندق cli ‌رو نصب کنید
2. یک سرویس MySQL ‌از طریق دستور managed-service ‌ایجاد می‌کنید.
3. یک داکر فایل برای وردپرس می‌نویسید و روی فندق پابلیش می‌کنید.
4. با ست کردن صحیح environment variables وردپرس رو دیپلوی می‌کنید.

::: tip نکته
اگر حوصله خوندن ندارید می‌تونید 
 [از این ریپو](https://github.com/fandoghpaas/fandogh-examples/tree/master/wordpress-mysql)
 استفاده کنید :-D
:::


### قدم اول: ساخت اکانت فندق و نصب CLI
کافیه یک سر به آدرس [فندق](http://fandogh.cloud/) بزنید و روی دکمه ثبت‌نام کلیک کنید، فکر نمی‌کنم بیشتر از ۱ دقیقه طول بکشه.
شما برای ارسال کامندهاتون به فندق به کلاینت فندق یا همون [Fandogh CLI](https://github.com/fandoghpaas/fandogh-cli) هم نیاز دارید که از طریق همین لینک می‌تونید به راحتی نصبش کنید.

### قدم دوم: ساخت سرویس MySQL
ما توی فندق یک قابلیتی ارائه میدیم به نام managed-service  که کمک می‌کنه سرویس‌های رایج رو ساده‌تر دیپلوی کنید.
مراحل کار به این شکل هستش:
قبل از هر چیز لازمه که لاگین کنیم
```
fandogh login
```
دیپلوی کردن یک سرویس managed  فقط یک کامند لازم داره به شرطی که اسم و ورژن سرویسی که میخواید دیپلوی کنید رو بدونید، مثلا برای دیپلوی MySQL ورژن 9.4 دستور زیر کفایت می‌کنه:
```
fandogh managed-service deploy mysql 9.4
```
وقتی دستور رو اجرا می‌کنید باید چنین خروجی مشاهده کنید:

```
Your Mysql service will be ready in a few seconds.
You can have access to the PHPMyAdmin via following link:
http://mysql.[YOURNAMESPACE].fandogh.cloud

```
اگر پیغام بالا رو مشاهده کردید یعنی سرویس MySQLاتون با موفقیت راه‌اندازی شده

اما حالا که داریم با managed-service کار می‌کنیم بذارید راجع به چند تا از آپشن‌های قابل اعمال هم صحبت کنیم.
همون طور که
[اینجا مستند شده](https://github.com/fandoghpaas/fandogh-cli#configuration)
شما برای دیپلوی کردن MySQL یه سری گزینه قابل تنظیم دارید:
* service_name
همون طور که توی مستندات فندق هست، همه سرویس‌هایی که داخل یک namespace در حال اجرا هستند یک DNS داخلی دارند و سرویس‌های مختلف از طریق service_name می‌تونند همدیگر رو پیدا کنند و به هم متصل بشند.
وقتی یک managed-service برای MySQL ایجاد می‌کنید اسم پیش‌فرضش mysql هستش، یعنی سرویس‌های دیگه باید توی شبکه دنبال نام mysql بگردند تا بهش وصل بشند، از طریق این گزینه می‌تونید اسم دیگه‌ای بهش نسبت بدید.

* phpmyadmin_enabled
از طریق این گزینه می‌تونید PHPMyAdmin رو فعال یا غیر فعال کنید

* mysql_root_password
این هم از اسمش پیداست، میشه از طریقش پسورد روت MySQL رو مشخص کرد


برای اینکه یک سری از امکانات دیگه فندق رو هم ببینیم  توی این ‌آموزش ما قصد نداریم از PHPMyAdmin استفاده کنیم، پس اجازه بدید به این شکل سرویس MySQL رو ایجاد کنیم:

```
fandogh managed-service deploy mysql 9.4 -c service_name=my-database -c phpmyadmin_enabled=false -c mysql_root_password=somepassword

```



### قدم سوم: نوشتن Dockerfile و پابلیش کردن وردپرس

برای اینکار یک دایرکتوری بسازید روی سیستم خودتون، مثلا اسمش رو می‌‌گذاریم my-wp-blog  و وارد اون دایرکتوری بشید.
یک فایل به نام `Dockerfile` بسازید و تنها چیزی که لازمه داخلش بنویسید همینه:
```
FROM wordpress

```
با اینکار ما یک Image کاملا مشابه با Image اصلی وردپرس ساختیم و از همون استفاده می‌کنیم، توضیحات مربوط به image اصلی وردپرس رو می‌تونید [اینجا](https://hub.docker.com/_/wordpress/) مشاهده کنید
حالا در حالی که داخل اون دایرکتوری هستید باید فقط یک فایل داشته باشید به نام Dockerfile  با محتویاتی که بالاتر اشاره کردم، الان کافیه که اول imageاتون رو روی فندق init کنید و بعد هم ورژن بزنید و پابلیش کنید:
```
fandogh image init
```
که از شما یک اسم می‌خواد، و
```
fandogh image publish
```
که از شما ورژن می‌خواد
اگر همه چیز خوب پیش بره باید وقتی لیست ورژن‌ها رو میگیرید این ورژن وضعیتش `BUILT` باشه:
```
fandogh image versions
```


### قدم چهارم و آخر: دیپلوی کردن وردپرس روی فندق

برای دیپلوی کردن imageای که توی قدم قبلی ساختیم باید از کامند `service deploy‍` فندق استفاده کنیم، اما باید به وردپرس بگیم که کجا باید دنبال دیتابیس بگرده 
طبق داکرفایلی که نوشتیم تو قدم قبلی image ما براساس 
[ایمیج رسمی وردپرس](https://hub.docker.com/_/wordpress/)
 ساخته شده و ایمیج رسمی وردپرس یه سری environment variable دریافت می‌کنه.پارامتر‌هایی که برای ما مهم هستند، پارامتر‌های مربوط به دیتابیس هستند( البته لیست کاملش توی همین لینکی که گذاشتم هست)‌:
* WORDPRESS_DB_HOST
* WORDPRESS_DB_USER
* WORDPRESS_DB_PASSWORD
* WORDPRESS_DB_NAME

ما می‌تونیم موقع دیپلوی سرویس این پارامتر‌ها رو هم از طریق `-e` ست کنیم بنابر این کامندی که اجرا می‌کنیم میشه این:

```
fandogh service deploy -e WORDPRESS_DB_HOST=my-database -e WORDPRESS_DB_USER=root -e WORDPRESS_DB_PASSWORD=somepassword -e WORDPRESS_DB_NAME=wp

```
مقدار هر کدوم از این متغیر‌ها رو از روی مقادیری که موقع ساخت سرویس MySQL مشخص کردیم باید بردارید.      
بعد از اجرا از شما در مورد اینکه کدوم ورژن رو مایلید دیپلوی کنید می‌پرسه و اینکه اسم سرویستون چیه و اگر همه چیز خوب پیش بره خروجی مورد نظر این باید باشه:

```
The image version: v1
Your service name: mywp
Your service deployed successfully.
The service is accessible via following link:
http://[YOUR-SERVICE-NAME].[YOUR-NAMESPACE].fandogh.cloud

```
اگر به آدرس بالا مراجعه کنید با صفحه نصب wordpress مواجه میشید و این یعنی سرویس وردپرس شما آماده است.

